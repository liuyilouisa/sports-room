import{u as c,a as u,j as e,b as d}from"./index-BUS16Z0V.js";import{u as p,a as x,b as h}from"./schemas-BYk0niwe.js";import{O as f,V as a}from"./index-G2bsMOGr.js";import{l as g}from"./auth-CsP-8yzr.js";function k(){const l=c(),n=u(s=>s.setUser),{register:t,handleSubmit:i,formState:{errors:r}}=p({resolver:x(g)}),{mutate:m,isPending:o,error:j}=h({mutationFn:d.login,onSuccess:({data:s})=>{a.success("登录成功"),localStorage.setItem("token",s.token),n(s.user),l("/")},onError:s=>{if(s?.message.includes("401")){a.error("邮箱或密码错误");return}else s?.message.includes("Network Error")?a.error("网络错误，请稍后重试"):a.error(s?.message||"登录失败，请重试")}});return e.jsxs(e.Fragment,{children:[e.jsx(f,{position:"top-center"}),e.jsxs("div",{className:"max-w-sm mx-auto mt-20 p-6 border rounded shadow",children:[e.jsx("h2",{className:"text-2xl mb-4",children:"登录"}),e.jsxs("form",{onSubmit:i(s=>m(s)),className:"space-y-4",children:[e.jsx("input",{...t("email"),placeholder:"邮箱","aria-label":"邮箱",className:"w-full input"}),r.email&&e.jsx("p",{className:"text-red-600 text-sm",children:r.email.message}),e.jsx("input",{type:"password",...t("password"),placeholder:"密码","aria-label":"密码",className:"w-full input"}),r.password&&e.jsx("p",{className:"text-red-600 text-sm",children:r.password.message}),e.jsx("button",{disabled:o,className:"btn btn-primary w-full",children:o?"登录中…":"登录"})]}),e.jsxs("p",{className:"text-center mt-4",children:["还没有账号？",e.jsx("a",{href:"/register",className:"link",children:"去注册"})]})]})]})}export{k as default};
