import{u as c,a as d,j as e,b as u}from"./index-BUS16Z0V.js";import{u as p,a as x,b as h}from"./schemas-BYk0niwe.js";import{O as f,V as t}from"./index-G2bsMOGr.js";import{r as j}from"./auth-CsP-8yzr.js";function k(){const o=c(),m=d(s=>s.setUser),{register:r,handleSubmit:i,formState:{errors:a}}=p({resolver:x(j)}),{mutate:n,isPending:l,error:g}=h({mutationFn:u.register,onSuccess:({data:s})=>{t.success("注册成功"),localStorage.setItem("token",s.token),m(s.user),o("/")},onError:s=>{if(s?.message.includes("409")){t.error("邮箱已被注册");return}else s?.message.includes("Network Error")?t.error("网络错误，请稍后重试"):t.error(s?.message||"注册失败，请重试")}});return e.jsxs(e.Fragment,{children:[e.jsx(f,{position:"top-center"}),e.jsxs("div",{className:"max-w-sm mx-auto mt-20 p-6 border rounded shadow",children:[e.jsx("h2",{className:"text-2xl mb-4",children:"注册"}),e.jsxs("form",{onSubmit:i(s=>n(s)),className:"space-y-4",children:[e.jsx("input",{...r("email"),placeholder:"邮箱","aria-label":"邮箱",className:"w-full input"}),a.email&&e.jsx("p",{className:"text-red-600 text-sm",children:a.email.message}),e.jsx("input",{...r("name"),placeholder:"昵称","aria-label":"昵称",className:"w-full input"}),a.name&&e.jsx("p",{className:"text-red-600 text-sm",children:a.name.message}),e.jsx("input",{type:"password",...r("password"),placeholder:"密码","aria-label":"密码",className:"w-full input"}),a.password&&e.jsx("p",{className:"text-red-600 text-sm",children:a.password.message}),e.jsx("input",{type:"password",...r("confirmPassword"),placeholder:"确认密码","aria-label":"确认密码",className:"w-full input"}),a.confirmPassword&&e.jsx("p",{className:"text-red-600 text-sm",children:a.confirmPassword.message}),e.jsx("button",{disabled:l,className:"btn btn-primary w-full",children:l?"注册中…":"注册"})]}),e.jsxs("p",{className:"text-center mt-4",children:["已有账号？",e.jsx("a",{href:"/login",className:"link",children:"去登录"})]})]})]})}export{k as default};
